<!--index.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ | ãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ä»˜ã</title>
    <style>
        /* --- åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒªã‚»ãƒƒãƒˆ --- */
        body { font-family: sans-serif; margin: 0; background-color: #f4f7f6; color: #333; }
        
        /* --- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆå³ä¸Šã®ãƒœã‚¿ãƒ³é…ç½®ç”¨ï¼‰ --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
            color: #1e88e5;
        }
        .auth-controls button {
            padding: 8px 15px; /* ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        #login-btn, #mypage-btn {
            background-color: #1e88e5;
            color: white;
        }
        #login-btn:hover, #mypage-btn:hover { background-color: #1565c0; }

        /* --- ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã‚¨ãƒªã‚¢ --- */
        .main-content {
            max-width: 1200px; /* â˜… æœ€å¤§å¹…ã‚’åºƒã’ã€ç”»åƒãŒè¦‹ã‚„ã™ããªã‚‹ã‚ˆã†ã«èª¿æ•´ */
            margin: 30px auto;
            padding: 0 15px;
        }
        .event-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); /* â˜… ã‚«ãƒ¼ãƒ‰ã‚µã‚¤ã‚ºã‚’å¾®èª¿æ•´ */
            gap: 30px; /* â˜… é–“éš”ã‚’åºƒã’ã¦è¦‹ã‚„ã™ã */
        }
        .event-card {
            background: white;
            /* padding: 20px; â˜… ç”»åƒã¨ã®å…¼ã­åˆã„ã§paddingã¯å»ƒæ­¢ï¼ˆã¾ãŸã¯èª¿æ•´ï¼‰*/
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* â˜… å½±ã‚’å¼·ã‚ã¦è¦‹æ „ãˆã‚¢ãƒƒãƒ— */
            position: relative;
            overflow: hidden; /* ç”»åƒãŒã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã« */
        }

        /* â˜… ç”»åƒã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  â˜… */
        .event-image {
            width: 100%;
            height: 200px; /* é«˜ã•ã‚’å›ºå®š */
            object-fit: cover; /* ç¸¦æ¨ªæ¯”ã‚’ç¶­æŒã—ã¤ã¤å…¨ä½“ã‚’è¦†ã† */
            display: block;
        }

        /* ã‚«ãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ */
        .card-content {
            padding: 20px;
        }

        .event-card h2 {
            margin-top: 0;
            color: #333;
            font-size: 22px; /* â˜… ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤§ãã */
            margin-bottom: 10px;
        }
        .event-card p {
            font-size: 15px;
            color: #666;
            margin-bottom: 10px;
        }
        .event-card p strong {
            color: #1e88e5; /* â˜… æ—¥æ™‚ã‚’å¼·èª¿ */
            font-weight: 600;
            display: inline-block;
            margin-right: 5px;
        }
        .favorite-btn {
            padding: 8px 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            background-color: #f0f0f0;
            transition: background-color 0.2s, border-color 0.2s;
            width: 100%; /* ãƒœã‚¿ãƒ³ã‚’ã‚«ãƒ¼ãƒ‰å¹…ã« */
            box-sizing: border-box;
            margin-top: 10px;
        }
        .favorite-btn.is-favorite {
            background-color: #ff5252;
            color: white;
            border-color: #ff5252;
        }
        
        /* --- ãƒ¢ãƒ¼ãƒ€ãƒ« (æ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ã¯ãã®ã¾ã¾) --- */
        .modal {
            display: none; 
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 450px;
            position: relative;
        }
        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 20px;
            cursor: pointer;
        }
        .close-btn:hover, .close-btn:focus {
            color: #333;
            text-decoration: none;
            cursor: pointer;
        }
        
        /* --- æ—¢å­˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ã‚¤ãƒ«ã®é©ç”¨ã¨èª¿æ•´ --- */
        input[type="email"], input[type="password"] {
            width: 100%; padding: 10px; margin: 8px 0; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px;
        }
        .auth-buttons button {
            width: 100%; padding: 12px; margin-bottom: 10px; border: none; border-radius: 4px; cursor: pointer; color: white; font-weight: bold;
        }
        #email-signup-btn, #email-login-btn { background-color: #4CAF50; }
        #google-login-btn { background-color: #DB4437; }
        #github-login-btn { background-color: #333; }
        #reauth-section { margin-top: 20px; padding: 15px; border: 1px solid #ffcc80; background-color: #fff3e0; border-radius: 4px; }
        hr { margin: 20px 0; border: 0; border-top: 1px solid #eee; }
    </style>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, GithubAuthProvider, signInWithPopup, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, linkWithCredential, setPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, getDocs, doc, getDoc, updateDoc, arrayUnion, arrayRemove, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        // ã‚ãªãŸã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®Firebaseè¨­å®š
        const firebaseConfig = {
            apiKey: "AIzaSyDt69H-dBGMB4HANbwVj007vJ3yblEZdqE",
            authDomain: "goto6234.firebaseapp.com",
            projectId: "goto6234",
            storageBucket: "goto6234.firebasestorage.app",
            messagingSenderId: "730149609843",
            appId: "1:730149609843:web:d11237de52723fc45b2506",
            measurementId: "G-FDRB7H8MRR"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentUser = null;
        let pendingCredential = null;
        let favoriteEventIds = [];

        // DOMè¦ç´ 
        const loginModal = document.getElementById('login-modal');
        const loginBtnHeader = document.getElementById('login-btn-header');
        const eventGrid = document.getElementById('event-grid');
        const reauthSection = document.getElementById('reauth-section');
        const loginFormMain = document.getElementById('login-form-main');

        // Firebase AuthåˆæœŸè¨­å®š
        setPersistence(auth, browserSessionPersistence)
            .then(() => console.log("Firebase Persistence set to Session."))
            .catch((error) => console.error("Failed to set persistence:", error));
            
        const googleProvider = new GoogleAuthProvider();
        const githubProvider = new GithubAuthProvider();
        
        // --- ãƒ‡ãƒ¼ã‚¿å‡¦ç†é–¢æ•° ---

        /**
         * ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŠæ°—ã«å…¥ã‚Šãƒªã‚¹ãƒˆã‚’Firestoreã‹ã‚‰èª­ã¿è¾¼ã‚€
         */
        const loadFavorites = async (uid) => {
            try {
                const userRef = doc(db, 'users', uid);
                const userSnap = await getDoc(userRef);
                if (userSnap.exists()) {
                    favoriteEventIds = userSnap.data().favorites || [];
                } else {
                    favoriteEventIds = [];
                }
            } catch (error) {
                console.error("ãŠæ°—ã«å…¥ã‚Šãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", error);
                favoriteEventIds = [];
            }
            renderEvents(); // èª­ã¿è¾¼ã¿å¾Œã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å†æç”»
        };
        
        /**
         * æ—¥ä»˜æ–‡å­—åˆ—ã‚’æ¯”è¼ƒã—ã‚„ã™ã„æ•°å€¤å½¢å¼ YYYYMMDD ã«å¤‰æ›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
         */
        const formatDateForComparison = (dateString) => {
            if (!dateString) return 0;
            // YYYY/MM/DDå½¢å¼ã‚’YYYYMMDDã«å¤‰æ›
            return parseInt(dateString.replace(/\//g, ''), 10);
        };


        /**
         * Firestoreã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã‚’å–å¾—ã—ã€è¡¨ç¤ºã™ã‚‹
         */
        const renderEvents = async () => {
            eventGrid.innerHTML = 'ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...';
            try {
                const eventsCol = collection(db, 'events');
                const eventSnapshot = await getDocs(eventsCol);
                
                let html = '';
                
                // ä»Šæ—¥ã®æ—¥ä»˜ã‚’å–å¾—ã—ã€æ¯”è¼ƒå½¢å¼ã«å¤‰æ›
                const today = new Date();
                const todayFormatted = formatDateForComparison(
                    `${today.getFullYear()}/${(today.getMonth() + 1).toString().padStart(2, '0')}/${today.getDate().toString().padStart(2, '0')}`
                );

                eventSnapshot.docs.forEach(doc => {
                    const data = doc.data();
                    const eventId = doc.id;
                    
                    // ã‚¤ãƒ™ãƒ³ãƒˆã®æ—¥ä»˜ã‚’æ¯”è¼ƒå½¢å¼ã«å¤‰æ›
                    const eventDateFormatted = formatDateForComparison(data.date);
                    
                    // â˜… çµ‚äº†ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆæ—¥ä»˜ãŒä»Šæ—¥ã‚ˆã‚Šéå»ã§ã‚ã‚Œã°éè¡¨ç¤ºï¼‰
                    if (eventDateFormatted < todayFormatted) {
                        return; // ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—
                    }

                    const isFavorite = favoriteEventIds.includes(eventId);

                    // â˜… æ™‚åˆ»ã‚’æ•´å½¢ (startTime, endTimeã®æœ‰ç„¡ã‚’ç¢ºèª)
                    const timeDisplay = (data.startTime && data.endTime) 
                                        ? `${data.startTime} ã€œ ${data.endTime}` 
                                        : 'çµ‚æ—¥';
                    
                    // â˜… ç”»åƒã®è¡¨ç¤º (imageUrlãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ <img> ã‚¿ã‚°ã‚’ç”Ÿæˆ)
                    const imageHtml = data.imageUrl 
                                      ? `<img src="${data.imageUrl}" alt="${data.name}" class="event-image" onerror="this.onerror=null;this.style.display='none';">` 
                                      : '';

                    html += `
                        <div class="event-card">
                            ${imageHtml} <div class="card-content"> <h2>${data.name}</h2>
                                <p>
                                    <strong>æ—¥ä»˜:</strong> ${data.date}<br>
                                    <strong>æ™‚åˆ»:</strong> ${timeDisplay} </p>
                                <p>${data.description}</p>
                                <button class="favorite-btn ${isFavorite ? 'is-favorite' : ''}" data-event-id="${eventId}" data-is-favorite="${isFavorite}">
                                    ${isFavorite ? 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Šè§£é™¤' : 'â­ ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ '}
                                </button>
                            </div>
                        </div>
                    `;
                });
                eventGrid.innerHTML = html;
                
                // ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
                document.querySelectorAll('.favorite-btn').forEach(btn => {
                    btn.addEventListener('click', handleFavoriteClick);
                });

            } catch (error) {
                console.error("ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", error);
                eventGrid.innerHTML = '<p>ã‚¤ãƒ™ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';
            }
        };

        // --- èªè¨¼çŠ¶æ…‹ã®ç›£è¦–ã¨UIæ›´æ–° (æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ãªã—) ---

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            
            if (user) {
                loginBtnHeader.textContent = `ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸ (${user.displayName || user.email || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼'})`;
                loginBtnHeader.onclick = () => window.location.href = 'mypage.html';
                loadFavorites(user.uid);
            } else {
                loginBtnHeader.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³ / ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—';
                loginBtnHeader.onclick = () => loginModal.style.display = 'block';
                favoriteEventIds = [];
                renderEvents(); 
            }
            
            if (!user && loginModal.style.display === 'block') {
                loginModal.style.display = 'none';
            }
            
            if (!eventGrid.innerHTML || user) {
            } else if (!user) {
                renderEvents();
            }

        });

        // --- ãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ã®ãƒ­ã‚¸ãƒƒã‚¯ (æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ãªã—) ---

        const handleFavoriteClick = async (event) => {
            const btn = event.currentTarget;
            const eventId = btn.dataset.eventId;

            if (!currentUser) {
                alert('ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚');
                loginModal.style.display = 'block';
                return;
            }

            const isFavorite = btn.dataset.isFavorite === 'true';
            const userRef = doc(db, 'users', currentUser.uid);
            
            try {
                if (isFavorite) {
                    await updateDoc(userRef, { favorites: arrayRemove(eventId) });
                    favoriteEventIds = favoriteEventIds.filter(id => id !== eventId);
                    alert('ãŠæ°—ã«å…¥ã‚Šã‚’è§£é™¤ã—ã¾ã—ãŸã€‚');
                } else {
                    await updateDoc(userRef, { favorites: arrayUnion(eventId) });
                    favoriteEventIds.push(eventId);
                    alert('ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸï¼');
                }
                
                btn.dataset.isFavorite = (!isFavorite).toString();
                btn.textContent = !isFavorite ? 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Šè§£é™¤' : 'â­ ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ';
                btn.classList.toggle('is-favorite');

            } catch (error) {
                if (error.code === 'not-found' && !isFavorite) {
                    await setDoc(userRef, { favorites: [eventId] });
                    favoriteEventIds = [eventId];
                    btn.dataset.isFavorite = 'true';
                    btn.textContent = 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Šè§£é™¤';
                    btn.classList.add('is-favorite');
                    alert('ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸï¼');
                } else {
                    console.error("ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã‚¨ãƒ©ãƒ¼:", error);
                    alert("å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error.message);
                }
            }
        };

        // --- ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ï¼ˆæ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ãªã—ï¼‰ ---

        const handleLoginSuccess = (message) => {
            alert(message);
            loginModal.style.display = 'none';
        };

        document.getElementById('google-login-btn').addEventListener('click', async () => {
            try {
                await signInWithPopup(auth, googleProvider);
                handleLoginSuccess('Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼');
            } catch (error) {
                handleSocialLoginError(error);
            }
        });

        document.getElementById('github-login-btn').addEventListener('click', async () => {
            try {
                await signInWithPopup(auth, githubProvider);
                handleLoginSuccess('GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼');
            } catch (error) {
                handleSocialLoginError(error);
            }
        });

        const emailInput = document.getElementById('email-input');
        const passwordInput = document.getElementById('password-input');

        document.getElementById('email-signup-btn').addEventListener('click', async () => {
            const email = emailInput.value;
            const password = passwordInput.value;
            if (!email || !password) return alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                handleLoginSuccess('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼');
            } catch (error) {
                console.error("Emailã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:", error);
                alert("Emailã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error.message);
            }
        });

        document.getElementById('email-login-btn').addEventListener('click', async () => {
            const email = emailInput.value;
            const password = passwordInput.value;
            if (!email || !password) return alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
            try {
                await signInWithEmailAndPassword(auth, email, password);
                handleLoginSuccess('ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼');
            } catch (error) {
                console.error("Emailãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼:", error);
                alert("Emailãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error.message);
            }
        });

        document.getElementById('reauth-login-btn').addEventListener('click', async () => {
            const email = document.getElementById('reauth-email-input').value;
            const password = document.getElementById('reauth-password-input').value;
            if (!email || !password) return alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
            if (!pendingCredential) {
                alert('ã‚¨ãƒ©ãƒ¼: ãƒªãƒ³ã‚¯å¯¾è±¡ã®èªè¨¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãƒªãƒˆãƒ©ã‚¤ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                await linkWithCredential(user, pendingCredential);
                alert('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªãƒ³ã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
                handleLoginSuccess('è¤‡æ•°ã®æ–¹æ³•ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼');
            } catch (error) {
                console.error("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªãƒ³ã‚¯/å†èªè¨¼ã‚¨ãƒ©ãƒ¼:", error);
                alert("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªãƒ³ã‚¯ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ãŸã‹ç¢ºèªã—ã¦ãã ã•ã„: " + error.message);
            }
        });

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹å‡¦ç†
        document.querySelector('.close-btn').addEventListener('click', () => {
            loginModal.style.display = 'none';
        });

        // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚’ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        window.onclick = function(event) {
            if (event.target == loginModal) {
                loginModal.style.display = 'none';
            }
        }
    </script>
</head>
<body>
    <header class="header">
        <h1>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ ğŸ—“ï¸</h1>
        <div class="auth-controls">
            <button id="login-btn-header">ãƒ­ã‚°ã‚¤ãƒ³ / ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—</button>
        </div>
    </header>

    <main class="main-content">
        <h2>é–‹å‚¬ä¸­ã®ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
        <div class="event-grid" id="event-grid">
            <p>ã‚¤ãƒ™ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™...</p>
        </div>
    </main>
    
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="container">
                <h2 style="text-align: center;">ğŸ” èªè¨¼ãƒ•ã‚©ãƒ¼ãƒ </h2>
                
                <div id="login-form-main">
                    <h3>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³</h3>
                    <div class="auth-buttons">
                        <button id="google-login-btn">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</button>
                        <button id="github-login-btn">GitHubã§ãƒ­ã‚°ã‚¤ãƒ³</button>
                    </div>

                    <hr>

                    <h3>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§èªè¨¼</h3>
                    <div>
                        <input type="email" id="email-input" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required>
                        <input type="password" id="password-input" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" required>
                        <div class="auth-buttons">
                            <button id="email-signup-btn">ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ— (ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ)</button>
                            <button id="email-login-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
                        </div>
                    </div>
                </div>

                <div id="reauth-section">
                    <h2>ğŸ¤ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªãƒ³ã‚¯</h2>
                    <p><strong>ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚</strong><br>
                        æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼æƒ…å ±ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’å…¥åŠ›ã—ã¦ãƒªãƒ³ã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
                    <div>
                        <input type="email" id="reauth-email-input" placeholder="æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required readonly>
                        <input type="password" id="reauth-password-input" placeholder="æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" required>
                        <div class="auth-buttons">
                            <button id="reauth-login-btn">ãƒªãƒ³ã‚¯ã‚’å®Œäº†ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
